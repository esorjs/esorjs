var S=Object.defineProperty;var H=e=>{throw TypeError(e)};var J=(e,t,n)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var i=(e,t)=>S(e,"name",{value:t,configurable:!0});var A=(e,t,n)=>J(e,typeof t!="symbol"?t+"":t,n),_=(e,t,n)=>t.has(e)||H("Cannot "+n);var M=(e,t,n)=>(_(e,t,"read from private field"),n?n.call(e):t.get(e)),b=(e,t,n)=>t.has(e)?H("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),j=(e,t,n,o)=>(_(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n),g=(e,t,n)=>(_(e,t,"access private method"),n);function O(e,t,n="error"){let o=n==="warn"?console.warn:console.error,r=t instanceof Error?t:new Error(String(t));return o(`[Esor Error] ${e}:`,r.message),r}i(O,"handleError");var h=null,L=["beforeMount","mount","beforeUpdate","update","destroy"],U=i(e=>{h=e,e._lifecycles=Object.fromEntries(L.map(t=>[t,[]])),e.runHook=t=>{let n=e._lifecycles?.[t];if(n?.length)for(let o=0;o<n.length;o++)queueMicrotask(()=>n[o].call(e))}},"createLifecycle"),z=i((e,t)=>{if(!h||!h._lifecycles){O("lifecycle",`Hook called outside ctx setup for "${e}"`);return}h._lifecycles[e].push(t)},"addHook"),F={};L.forEach(e=>{let t=e.startsWith("before")?e:`on${e.charAt(0).toUpperCase()+e.slice(1)}`;F[t]=n=>z(e,n)});var{beforeMount:Y,onMount:Q,beforeUpdate:Z,onUpdate:v,onDestroy:ee}=F,te=i(e=>{let t=e();return typeof t=="function"&&z("destroy",t),()=>{}},"onEffect"),ne=i(()=>(h||console.warn("getCurrentContext called outside of component lifecycle"),h),"getCurrentContext");var a=null,C=0,k=[],y=i(e=>{let t=[];return n=>{if(n===void 0)return a&&!t.includes(a)&&(t.push(a),a.deps?.add(t)),e;let o=typeof n=="function"?n(e):n;if(e!==o)if(e=o,C>0)for(let r=0;r<t.length;r++)k.includes(t[r])||k.push(t[r]);else for(let r=0;r<t.length;r++)t[r]();return e}},"signal"),d=i(e=>{let t=new Set,n=i(()=>{for(let o of t){let r=o.indexOf(n);r!==-1&&o.splice(r,1)}t.clear(),a=n,a.deps=t,e(),a=null},"run");return n(),()=>{for(let o of t){let r=o.indexOf(n);r!==-1&&o.splice(r,1)}t.clear()}},"effect"),G=i(e=>{let t=y();return d(()=>t(e())),t},"computed"),V=i(e=>{C++;try{return e()}finally{if(--C,C===0){let t=k.splice(0);for(let n=0;n<t.length;n++)t[n]()}}},"batch");var oe=/^-?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/;function re(e){if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;if(oe.test(e))return Number(e);if(typeof e=="string"&&(e[0]==="{"||e[0]==="["))try{return JSON.parse(e)}catch{}return e}i(re,"parseAttributeValue");function $(e){for(let t of e.attributes){let{name:n,value:o}=t;n.startsWith("on")||n.startsWith("ref")||(e.props[n]=y(re(o)))}}i($,"initializeProps");function T(e,t,n=null){let o=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n?.dispatchEvent(o),o}i(T,"emit");function B(e){e&&(e.emit=(t,n)=>T(t,n,e))}i(B,"initDispatch");function p(e,{mark:t=!1,parent:n=null}={}){let o=document.createDocumentFragment();if(!e?.length)return o;for(let r of e)r&&(t&&(r._marker=!0),o.appendChild(Array.isArray(r)?p(r,{mark:t}):r));return n&&o.childNodes.length&&n.appendChild(o),o}i(p,"createFragment");function W(e){return Object.keys(e).reduce((t,n)=>e[n]?t+n+" ":t,"").trim()}i(W,"joinTruthy");var ie=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,se=i((e,t={})=>{var n,o,r,q,w,l;return l=class extends HTMLElement{constructor(){super();b(this,r);b(this,n,this.attachShadow({mode:t.shadowMode||"open"}));b(this,o,!1);A(this,"props",Object.create(null));A(this,"_cleanup",[]);g(this,r,q).call(this),this.runHook("beforeMount")}connectedCallback(){g(this,r,w).call(this,!0)&&this.runHook("mount")}disconnectedCallback(){this._cleanup.forEach(f=>f()),this._cleanup=[],this.runHook("destroy"),g(this,r,w).call(this,!1)}},n=new WeakMap,o=new WeakMap,r=new WeakSet,q=i(function(){U(this),B(this),$(this);let f=e?.call(this,this.props),m=typeof f=="function"?f():f;p(m||[m],{parent:M(this,n)})},"#initializeComponent"),w=i(function(f){return M(this,o)===f?!1:(j(this,o,f),!0)},"#setMounted"),l},"BaseComponent"),ce=i((e,t,n={})=>{typeof customElements<"u"&&ie.test(e)&&!customElements.get(e)&&customElements.define(e,se(t,n))},"component");var D=i(e=>e==null?"":String(e).replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[t]),"sanitizeHtml");function K(e,t){if(!t?.parentNode)return;let n=t.parentNode,o=t._marker||[];if(!e?.length){for(let s of o)s.nodes.forEach(f=>f?.parentNode?.removeChild(f));t._marker=[];return}let r=new Map(o.map(s=>[s.key,s])),c=e.map((s,f)=>(s=Array.isArray(s)?s.filter(Boolean):[s],{key:s.find(I=>I?.getAttribute?.("key"))?.getAttribute("key")||`__index_${f}`,nodes:s})),u=new Map(c.map(s=>[s.key,s]));for(let s of o)u.has(s.key)||s.nodes.forEach(f=>f?.parentNode?.removeChild(f));let l=t;for(let s of c){let f=r.get(s.key);f?(R(f.nodes,s.nodes,n),f.nodes[0]!==l.nextSibling&&n.insertBefore(p(f.nodes),l.nextSibling),s.nodes=f.nodes):n.insertBefore(p(s.nodes,{mark:!0}),l.nextSibling),l=s.nodes[s.nodes.length-1]||l}t._marker=c}i(K,"reconcile");function R(e,t,n){for(let o=0;o<Math.max(e.length,t.length);o++){let r=e[o],c=t[o];!r&&c?n.appendChild(c):r&&!c?(r._cleanup?.(),n.removeChild(r)):r&&c&&(r.nodeType!==c.nodeType||r.tagName!==c.tagName?n.replaceChild(c,r):r.nodeType===3?r.nodeValue!==c.nodeValue&&(r.nodeValue=c.nodeValue):r.nodeType===1&&(fe(r,c),R([...r.childNodes],[...c.childNodes],r)))}}i(R,"patchNodes");function fe(e,t){let n={},o=new Set;for(let{name:r,value:c}of e.attributes)n[r]=c;for(let{name:r,value:c}of t.attributes)n[r]!==c&&e.setAttribute(r,c),o.add(r);for(let r in n)o.has(r)||e.removeAttribute(r)}i(fe,"patchAttributes");var P=new WeakMap,x="\uFEFF",N=i((e,t,n)=>{if(t)if(e.removeAttribute(t),t==="ref")typeof n=="function"?n(e):n&&(n.current=e);else if(t[0]==="o"&&t[1]==="n"&&typeof n=="function"){let o=t.slice(2).toLowerCase();e.addEventListener(o,n),e._cleanup=()=>e.removeEventListener(o,n)}else t==="style"&&typeof n=="object"?d(()=>Object.assign(e.style,n)):d(()=>le(e,t,typeof n=="function"?n():n));else pe(e,n)},"render");function le(e,t,n){t==="value"||t==="checked"?e[t]=n:n===!1||n===null||n===void 0?e.removeAttribute(t):e.setAttribute(t,typeof n=="object"?W(n):n)}i(le,"setAttribute");function ue(e,t){let n=e.parentNode,o=e.nextSibling;for(;o&&o._marker;)o._cleanup?.(),n.removeChild(o),o=e.nextSibling;t?.length&&ae(p(t,{mark:!0}),n,e.nextSibling)}i(ue,"replaceNodes");function pe(e,t){let n=i(o=>{if((o===!0||o===!1)&&(o=""),Array.isArray(o))K(o,e);else{let r=o==null?"":String(o),c=document.createTextNode(D(r));ue(e,[c])}},"updateContent");typeof t=="function"?d(()=>n(t())):n(t)}i(pe,"setContent");function ae(e,t,n=null){!e||!t||(n&&n.parentNode===t?t.insertBefore(e,n):t.appendChild(e))}i(ae,"insertFragment");function de(e,t){let n=[],o=document.createTreeWalker(e.content,5);for(;o.nextNode();)n.push(o.currentNode);let r=0;for(let c=0;c<n.length;c++){let u=n[c];if(u.nodeType===1&&u.attributes.length)for(let l of Array.from(u.attributes))l.value===x&&N(u,l.name,t[r++]);else if(u.nodeType===3&&u.nodeValue.includes(x))if(u.nodeValue===x){let l=document.createComment("");u.parentNode.replaceChild(l,u),N(l,null,t[r++])}else{let l=E(u.nodeValue.replaceAll(x,"<!>")),s=Array.from(l.content.childNodes);for(let f=0;f<s.length;f++){let m=s[f];m.nodeType===8&&N(m,null,t[r++])}u.parentNode.replaceChild(l.content,u)}}}i(de,"processTemplate");var E=i((e,t)=>{let n=document.createElement("template");return n.innerHTML=e,t?.as==="nodes"?[...n.content.childNodes]:n},"createNodes"),X=i((e,...t)=>{let n=P.get(e)||(P.set(e,e),e);if(!t.length)return n.length===1?E(n[0],{as:"nodes"}):E(n.join(""),{as:"nodes"});let o=E(n.join(x));return de(o,t),[...o.content.childNodes]},"html");function me(e=null){let t=e;return n=>n!==void 0?t=n:t}i(me,"ref");export{V as batch,Y as beforeMount,Z as beforeUpdate,ce as component,G as computed,d as effect,T as emit,ne as getCurrentContext,X as html,ee as onDestroy,te as onEffect,Q as onMount,v as onUpdate,me as ref,y as signal};
//# sourceMappingURL=esor.min.js.map
