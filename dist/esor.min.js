var R=Object.defineProperty;var N=e=>{throw TypeError(e)};var $=(e,t,n)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var k=(e,t,n)=>$(e,typeof t!="symbol"?t+"":t,n),S=(e,t,n)=>t.has(e)||N("Cannot "+n);var _=(e,t,n)=>(S(e,t,"read from private field"),n?n.call(e):t.get(e)),A=(e,t,n)=>t.has(e)?N("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var v=(e,t,n)=>(S(e,t,"access private method"),n);var g=null,M=0,d=null,T=!1;function H(){for(T=!1;d;){let e=d;d=null;for(let t of e)t()}}var O=e=>{let t=e,n=new Set;return(...r)=>{if(!r.length)return g&&n.add(g),t;let u=r[0];if(t!==u)if(t=u,M){d||(d=new Set);for(let c of n)d.add(c)}else{d||(d=new Set);for(let c of n)d.add(c);T||(T=!0,queueMicrotask(H))}return t}},y=e=>{let t=()=>{g=t,e(),g=null};return t(),t},q=e=>{let t=O(void 0);return y(()=>t(e())),t},B=e=>{M++;let t=e();return!--M&&d&&H(),t};var w=[],G=()=>w.pop()||document.createElement("div"),K=e=>{e.textContent="",w.length<10&&w.push(e)};function D(e,t){let n=new Map,r=e.children;for(let c=0;c<r.length;c++){let o=r[c];o._key!==void 0&&n.set(o._key,o)}let u=[];for(let c=0;c<t.length;c++){let o=t[c],f=o._key,l=n.get(f),p=G();x(p,o);let s=p.firstElementChild;l&&s?(F(l,s),u.push(l),n.delete(f)):s&&(s._key=f,u.push(s)),K(p)}for(let c of n.values())c._cleanup?.(),e.removeChild(c);for(let c=0;c<u.length;c++){let o=u[c],f=r[c];f!==o&&e.insertBefore(o,f||null)}}function F(e,t){let n=e.nodeType,r=t.nodeType;if(n===1&&r===1){if(e.tagName!==t.tagName){e.replaceWith(t.cloneNode(!0));return}let u=e.attributes,c=t.attributes,o=[];for(let i=u.length-1;i>=0;i--){let{name:m}=u[i];!t.hasAttribute(m)&&o.push(m)}for(let i=0;i<c.length;i++){let{name:m,value:h}=c[i];m==="value"||m==="checked"?e[m]!==h&&(e[m]=h):e.getAttribute(m)!==h&&e.setAttribute(m,h)}for(let i=0;i<o.length;i++)e.removeAttribute(o[i]);let f=e.childNodes,l=t.childNodes,p=f.length,s=l.length,a=Math.max(p,s);for(let i=0;i<a;i++){let m=f[i],h=l[i];m?h?F(m,h):(m._cleanup?.(),e.removeChild(m)):e.appendChild(h.cloneNode(!0))}}else n===3&&r===3?e.textContent!==t.textContent&&(e.textContent=t.textContent):e.replaceWith(t.cloneNode(!0))}var E="\uFEFF",P=new WeakMap,X=(e,...t)=>{let n=P.get(e);if(!n){let f=document.createElement("template");f.innerHTML=e.join(E);let l=e.findIndex(p=>p.trim().endsWith("key="));n={template:f,keyAttrIndex:l},P.set(e,n)}let{template:r,keyAttrIndex:u}=n,c,o=[...t];return u!==-1&&(c=t[u],o.splice(u,1)),{template:r,values:o,_isTemplate:!0,_key:c}},L=(e,t,n=!0)=>{if(Array.isArray(t)){if(t.length&&t[0]?._key!==void 0){D(e,t);return}n&&!(e instanceof DocumentFragment)&&(e.textContent="");for(let r=0;r<t.length;r++){let u=document.createDocumentFragment();L(u,t[r],!1),e.appendChild(u)}return}n&&!(e instanceof DocumentFragment)&&(e.textContent=""),!(t==null||t===!1)&&(t._isTemplate?x(e,t):t instanceof Node?e.appendChild(t):e.appendChild(document.createTextNode(String(t))))},x=(e,{template:t,values:n})=>{let r=t.content.cloneNode(!0),u=0,c=o=>{if(o.nodeType===Node.TEXT_NODE&&o.nodeValue.includes(E)){let f=o.nodeValue.split(E),l=document.createDocumentFragment();for(let p=0;p<f.length;p++){if(p>0){let s=n[u++];if(typeof s=="function"){let a=document.createElement("span");l.appendChild(a),y(()=>L(a,s()))}else L(l,s,!1)}f[p]&&l.appendChild(document.createTextNode(f[p]))}o.parentNode.replaceChild(l,o)}else if(o.nodeType===Node.ELEMENT_NODE){let f=[];for(let l=0;l<o.attributes.length;l++){let p=o.attributes[l];p.name!=="key"&&p.value===E&&f.push(p)}for(let l=0;l<f.length;l++){let p=f[l],s=n[u++],a=p.name;if(o.removeAttribute(a),a==="ref")typeof s=="function"?s(o):s&&(s.current=o);else if(a==="style"&&s&&typeof s=="object")typeof s=="function"?y(()=>Object.assign(o.style,s())):Object.assign(o.style,s);else if(a[0]==="o"&&a[1]==="n"){let i=a.slice(2).toLowerCase();typeof s=="function"&&(o._cleanup?.(),o.addEventListener(i,s),o._cleanup=()=>o.removeEventListener(i,s))}else typeof s=="function"?o.tagName?.includes("-")?(o._functionProps||(o._functionProps={}),o._functionProps[a]=s):y(()=>{let i=s();a==="value"||a==="checked"||a==="selected"?o[a]=i:i==null||i===!1?o.removeAttribute(a):o.setAttribute(a,i===!0?"":i)}):a==="value"||a==="checked"||a==="selected"?o[a]=s:s==null||s===!1||o.setAttribute(a,s===!0?"":s)}o.hasAttribute("key")&&o.removeAttribute("key");for(let l=0;l<o.childNodes.length;l++)c(o.childNodes[l])}};for(let o=0;o<r.childNodes.length;o++)c(r.childNodes[o]);e.appendChild(r)};var b=null,j=["beforeMount","mount","beforeUpdate","update","destroy"],z=e=>{b=e,e._lifecycles=Object.fromEntries(j.map(t=>[t,[]])),e.runHook=t=>{let n=e._lifecycles?.[t];n?.length&&queueMicrotask(()=>{for(let r=0;r<n.length;r++)n[r].call(e)})}},U=(e,t)=>{if(!b?._lifecycles)throw new Error(`[Esor] Hook called outside ctx setup for "${e}"`);b._lifecycles[e].push(t)},I={};j.forEach(e=>{let t=e.startsWith("before")?e:`on${e[0].toUpperCase()}${e.slice(1)}`;I[t]=n=>U(e,n)});var J=e=>{let t=e();return typeof t=="function"&&U("destroy",t),()=>{}},Y=()=>(!b&&console.warn("getCurrentContext called outside of component lifecycle"),b),{beforeMount:Q,onMount:Z,beforeUpdate:ee,onUpdate:te,onDestroy:ne}=I;var oe=e=>{if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;let t=e[0];if(t==="-"||t>="0"&&t<="9"){let n=+e;if(n===n)return n}if(t==="{"||t==="[")try{return JSON.parse(e)}catch{}return e},V=e=>{e._functionProps&&Object.assign(e.props,e._functionProps);let t=e.attributes;for(let n=0;n<t.length;n++){let{name:r,value:u}=t[n],c=r[0],o=r[1];c==="o"&&o==="n"||c==="r"&&o==="e"&&r[2]==="f"||u==="function"&&e._functionProps?.[r]||(e.props[r]=oe(u))}};var C=()=>C.cache||(C.cache=[...document.querySelectorAll("head style, head link[rel=stylesheet]")]);var re=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,ce=(e,t={})=>{var n,r,W,c;return c=class extends HTMLElement{constructor(){super();A(this,r);A(this,n,this.attachShadow({mode:t.shadowMode||"open"}));k(this,"props",Object.create(null));k(this,"_cleanup",[]);v(this,r,W).call(this),this.runHook("beforeMount")}connectedCallback(){this.runHook("mount")}disconnectedCallback(){this._cleanup.forEach(f=>f()),this._cleanup=[],this.runHook("destroy")}},n=new WeakMap,r=new WeakSet,W=function(){z(this),V(this),t.globalStyles&&C().forEach(l=>_(this,n).appendChild(l.cloneNode(!0)));let f=e?.call(this,this.props);x(_(this,n),f)},c},se=(e,t,n={})=>{typeof customElements<"u"&&re.test(e)&&!customElements.get(e)&&customElements.define(e,ce(t,n))};function le(e=null){let t=e;return(...n)=>n.length===0?t:t=n[0]}function ie(e,t,n=null){let r=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n?.dispatchEvent(r),r}export{B as batch,Q as beforeMount,ee as beforeUpdate,se as component,q as computed,y as effect,ie as emit,Y as getCurrentContext,X as html,ne as onDestroy,J as onEffect,Z as onMount,te as onUpdate,le as ref,O as signal};
//# sourceMappingURL=esor.min.js.map
