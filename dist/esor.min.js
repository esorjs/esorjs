var $=Object.defineProperty;var O=e=>{throw TypeError(e)};var q=(e,t,n)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var M=(e,t,n)=>q(e,typeof t!="symbol"?t+"":t,n),I=(e,t,n)=>t.has(e)||O("Cannot "+n);var N=(e,t,n)=>(I(e,t,"read from private field"),n?n.call(e):t.get(e)),T=(e,t,n)=>t.has(e)?O("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var P=(e,t,n)=>(I(e,t,"access private method"),n);var C=null,S=0,d=null,L=!1;function w(){for(L=!1;d;){let e=d;d=null;for(let t of e)t()}}var F=e=>{let t=e,n=new Set,s=(...p)=>{if(!p.length)return C&&n.add(C),t;let c=p[0];if(t!==c)if(t=c,S){d||(d=new Set);for(let i of n)d.add(i)}else{d||(d=new Set);for(let i of n)d.add(i);L||(L=!0,queueMicrotask(w))}return t};return s._isSignal=!0,s},y=e=>{let t=()=>{C=t,e(),C=null};return t(),t},G=e=>{let t=F(void 0);return y(()=>t(e())),t},K=e=>{S++;let t=e();return!--S&&d&&w(),t};var v=[],J=50,Y=()=>v.pop()||document.createElement("div"),Z=e=>{e.textContent="",e.innerHTML="",v.length<J&&v.push(e)};function D(e,t){let n=new Map,s=e.children;for(let c=0;c<s.length;c++){let i=s[c];i._key!==void 0&&n.set(i._key,i)}let p=[];for(let c=0;c<t.length;c++){let i=t[c],l=i._key,o=n.get(l),a=Y();b(a,i);let f=a.firstElementChild;o&&f?(x(o,f),p.push(o),n.delete(l)):f&&(f._key=l,p.push(f)),Z(a)}for(let c of n.values())c._cleanup?.(),e.removeChild(c);for(let c=0;c<p.length;c++){let i=p[c],l=s[c];l!==i&&e.insertBefore(i,l||null)}}function z(e,t){return e.nodeType===t.nodeType&&(e.nodeType!==1||e.tagName===t.tagName)}function Q(e,t,n){let s=t.length,p=n.length;if(s<20&&p<20){let a=Math.max(s,p);for(let f=0;f<a;f++){let m=t[f],r=n[f];m?r?x(m,r):(m._cleanup?.(),e.removeChild(m)):e.appendChild(r.cloneNode(!0))}return}let c=0;for(;c<s&&c<p&&z(t[c],n[c]);)x(t[c],n[c]),c++;let i=s-1,l=p-1;for(;i>=c&&l>=c&&z(t[i],n[l]);)x(t[i],n[l]),i--,l--;if(c>i&&c<=l){let a=n[l+1]?.nextSibling||null;for(let f=c;f<=l;f++)e.insertBefore(n[f].cloneNode(!0),a);return}if(c>l){for(let a=c;a<=i;a++)t[a]._cleanup?.(),e.removeChild(t[a]);return}let o=Math.max(i-c+1,l-c+1);for(let a=0;a<o;a++){let f=c+a,m=c+a,r=f<=i?t[f]:null,u=m<=l?n[m]:null;!r&&u?e.insertBefore(u.cloneNode(!0),t[f]||null):r&&!u?(r._cleanup?.(),e.removeChild(r)):r&&u&&x(r,u)}}function x(e,t){let n=e.nodeType,s=t.nodeType;if(n===1&&s===1){if(e.tagName!==t.tagName){e.replaceWith(t.cloneNode(!0));return}let p=e.attributes,c=t.attributes,i=[];for(let l=p.length-1;l>=0;l--){let{name:o}=p[l];!t.hasAttribute(o)&&i.push(o)}for(let l=0;l<c.length;l++){let{name:o,value:a}=c[l];o==="value"||o==="checked"?e[o]!==a&&(e[o]=a):e.getAttribute(o)!==a&&e.setAttribute(o,a)}for(let l=0;l<i.length;l++)e.removeAttribute(i[l]);Q(e,e.childNodes,t.childNodes)}else n===3&&s===3?e.textContent!==t.textContent&&(e.textContent=t.textContent):e.replaceWith(t.cloneNode(!0))}var k="\uFEFF",j=new WeakMap,g=new WeakMap,H=20,ee=(e,...t)=>{let n=j.get(e);if(!n){let a=document.createElement("template");a.innerHTML=e.join(k);let f=e.findIndex(m=>m.trim().endsWith("key="));n={template:a,keyAttrIndex:f},j.set(e,n)}let{template:s,keyAttrIndex:p}=n,c,i=[...t];p!==-1&&(c=t[p],i.splice(p,1));let l=i.some(a=>a?._isSignal||typeof a=="function"),o=i.length===0;return{template:s,values:i,_isTemplate:!0,_key:c,_isStatic:o,_hasReactiveValues:l}},A=(e,t,n=!0)=>{if(Array.isArray(t)){if(t.length&&t[0]?._key!==void 0){D(e,t);return}n&&!(e instanceof DocumentFragment)&&(e.textContent="");for(let s=0;s<t.length;s++){let p=document.createDocumentFragment();A(p,t[s],!1),e.appendChild(p)}return}n&&!(e instanceof DocumentFragment)&&(e.textContent=""),!(t==null||t===!1)&&(t._isTemplate?b(e,t):t instanceof Node?e.appendChild(t):e.appendChild(document.createTextNode(String(t))))},b=(e,{template:t,values:n,_isStatic:s,_hasReactiveValues:p})=>{if(s){let o=g.get(t);o?o=o.cloneNode(!0):(o=t.content.cloneNode(!0),g.size<H&&g.set(t,t.content.cloneNode(!0))),e.appendChild(o);return}if(!p&&g.size<H){let o=g.get(t);if(o){e.appendChild(o.cloneNode(!0));return}}let c=t.content.cloneNode(!0),i=0,l=o=>{if(o.nodeType===Node.TEXT_NODE&&o.nodeValue.includes(k)){let a=o.nodeValue.split(k),f=document.createDocumentFragment();for(let m=0;m<a.length;m++){if(m>0){let r=n[i++];if(r?._isSignal){let u=document.createElement("span");f.appendChild(u),y(()=>A(u,r()))}else if(typeof r=="function"){let u=document.createElement("span");f.appendChild(u),y(()=>A(u,r()))}else A(f,r,!1)}a[m]&&f.appendChild(document.createTextNode(a[m]))}o.parentNode.replaceChild(f,o)}else if(o.nodeType===Node.ELEMENT_NODE){let a=[];for(let f=0;f<o.attributes.length;f++){let m=o.attributes[f];m.name!=="key"&&m.value===k&&a.push(m)}for(let f=0;f<a.length;f++){let m=a[f],r=n[i++],u=m.name;if(o.removeAttribute(u),u==="ref")typeof r=="function"?r(o):r&&(r.current=o);else if(u==="style"&&r&&typeof r=="object")typeof r=="function"?y(()=>Object.assign(o.style,r())):Object.assign(o.style,r);else if(u[0]==="o"&&u[1]==="n"){let h=u.slice(2).toLowerCase();typeof r=="function"&&(o._cleanup?.(),o.addEventListener(h,r),o._cleanup=()=>o.removeEventListener(h,r))}else r?._isSignal?o.tagName?.includes("-")?(o._functionProps||(o._functionProps={}),o._functionProps[u]=r):y(()=>{let h=r();u==="value"||u==="checked"||u==="selected"?o[u]=h:h==null||h===!1?o.removeAttribute(u):o.setAttribute(u,h===!0?"":h)}):typeof r=="function"?o.tagName?.includes("-")?(o._functionProps||(o._functionProps={}),o._functionProps[u]=r):y(()=>{let h=r();u==="value"||u==="checked"||u==="selected"?o[u]=h:h==null||h===!1?o.removeAttribute(u):o.setAttribute(u,h===!0?"":h)}):u==="value"||u==="checked"||u==="selected"?o[u]=r:r==null||r===!1||o.setAttribute(u,r===!0?"":r)}o.hasAttribute("key")&&o.removeAttribute("key");for(let f=0;f<o.childNodes.length;f++)l(o.childNodes[f])}};for(let o=0;o<c.childNodes.length;o++)l(c.childNodes[o]);!p&&g.size<H&&g.set(t,c.cloneNode(!0)),e.appendChild(c)};var E=null,R=["beforeMount","mount","beforeUpdate","update","destroy"],U=e=>{E=e,e._lifecycles=Object.fromEntries(R.map(t=>[t,[]])),e.runHook=t=>{let n=e._lifecycles?.[t];n?.length&&queueMicrotask(()=>{for(let s=0;s<n.length;s++)n[s].call(e)})}},V=(e,t)=>{if(!E?._lifecycles)throw new Error(`[Esor] Hook called outside ctx setup for "${e}"`);E._lifecycles[e].push(t)},W={};R.forEach(e=>{let t=e.startsWith("before")?e:`on${e[0].toUpperCase()}${e.slice(1)}`;W[t]=n=>V(e,n)});var te=e=>{let t=e();return typeof t=="function"&&V("destroy",t),()=>{}},ne=()=>(!E&&console.warn("getCurrentContext called outside of component lifecycle"),E),{beforeMount:oe,onMount:ce,beforeUpdate:se,onUpdate:re,onDestroy:ie}=W;var le=e=>{if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;let t=e[0];if(t==="-"||t>="0"&&t<="9"){let n=+e;if(n===n)return n}if(t==="{"||t==="[")try{return JSON.parse(e)}catch{}return e},B=e=>{e._functionProps&&Object.assign(e.props,e._functionProps);let t=e.attributes;for(let n=0;n<t.length;n++){let{name:s,value:p}=t[n],c=s[0],i=s[1];c==="o"&&i==="n"||c==="r"&&i==="e"&&s[2]==="f"||p==="function"&&e._functionProps?.[s]||(e.props[s]=le(p))}};var _=()=>_.cache||(_.cache=[...document.querySelectorAll("head style, head link[rel=stylesheet]")]);var fe=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,ue=(e,t={})=>{var n,s,X,c;return c=class extends HTMLElement{constructor(){super();T(this,s);T(this,n,this.attachShadow({mode:t.shadowMode||"open"}));M(this,"props",Object.create(null));M(this,"_cleanup",[]);P(this,s,X).call(this),this.runHook("beforeMount")}connectedCallback(){this.runHook("mount")}disconnectedCallback(){this._cleanup.forEach(l=>l()),this._cleanup=[],this.runHook("destroy")}},n=new WeakMap,s=new WeakSet,X=function(){U(this),B(this),t.globalStyles&&_().forEach(o=>N(this,n).appendChild(o.cloneNode(!0)));let l=e?.call(this,this.props);b(N(this,n),l)},c},ae=(e,t,n={})=>{typeof customElements<"u"&&fe.test(e)&&!customElements.get(e)&&customElements.define(e,ue(t,n))};function pe(e=null){let t=e;return(...n)=>n.length===0?t:t=n[0]}function me(e,t,n=null){let s=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n?.dispatchEvent(s),s}export{K as batch,oe as beforeMount,se as beforeUpdate,ae as component,G as computed,y as effect,me as emit,ne as getCurrentContext,ee as html,ie as onDestroy,te as onEffect,ce as onMount,re as onUpdate,pe as ref,F as signal};
//# sourceMappingURL=esor.min.js.map
