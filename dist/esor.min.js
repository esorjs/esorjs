var H=Object.defineProperty;var V=e=>{throw TypeError(e)};var Z=(e,t,n)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var r=(e,t)=>H(e,"name",{value:t,configurable:!0});var _=(e,t,n)=>Z(e,typeof t!="symbol"?t+"":t,n),z=(e,t,n)=>t.has(e)||V("Cannot "+n);var C=(e,t,n)=>(z(e,t,"read from private field"),n?n.call(e):t.get(e)),M=(e,t,n)=>t.has(e)?V("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),w=(e,t,n,o)=>(z(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var p=null,b=0,k=new Set,m=r(e=>{let t=e,n=[],o=r(i=>{if(i===void 0)return p&&!n.includes(p)&&(n.push(p),p.subs&&p.subs.add(o)),t;let f=typeof i=="function"?i(t):i;if(!Object.is(f,t))if(t=f,b>0)for(let s=0;s<n.length;s++)k.add(n[s]);else{let s=n.slice();for(let l=0;l<s.length;l++)s[l]()}return t},"getterSetter");return o.subs=n,o},"signal"),a=r(e=>{let t=new Set,n=!1,o=r(()=>{if(n)return;n=!0;let i=p;p=o;try{e()}finally{p=i,n=!1}},"reactive");return o.subs=t,o(),()=>{t.forEach(i=>{let f=i.subs.indexOf(o);f!==-1&&i.subs.splice(f,1)}),t.clear()}},"effect"),T=r(e=>{let t=m(e());return a(()=>t(e())),()=>t()},"computed"),S=r(e=>{b++;try{return e()}finally{if(b--,b===0){let t=Array.from(k);k.clear(),t.forEach(n=>n())}}},"batch");function g(e,t,n=null){let o=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n?.dispatchEvent(o),o}r(g,"emit");function L(e=null){let t=e;return n=>n!==void 0?t=n:t}r(L,"ref");var O=r(e=>e==null?"":String(e).replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[t]),"sanitizeHtml");function d(e,{mark:t=!1,parent:n=null}={}){let o=document.createDocumentFragment();if(!e?.length)return o;for(let i of e)i&&(t&&(i._marker=!0),o.appendChild(Array.isArray(i)?d(i,{mark:t}):i));return n&&o.childNodes.length&&n.appendChild(o),o}r(d,"createFragment");function U(e){return Object.keys(e).reduce((t,n)=>e[n]?t+n+" ":t,"").trim()}r(U,"joinTruthy");function G(e,t){if(!t?.parentNode)return;let n=t.parentNode,o=t._marker||[];if(!e?.length){for(let c of o)c.nodes.forEach(u=>u?.parentNode?.removeChild(u));t._marker=[];return}let i=new Map(o.map(c=>[c.key,c])),f=e.map((c,u)=>(c=Array.isArray(c)?c.filter(Boolean):[c],{key:c.find(Y=>Y?.getAttribute?.("key"))?.getAttribute("key")||`__index_${u}`,nodes:c})),s=new Map(f.map(c=>[c.key,c]));for(let c of o)s.has(c.key)||c.nodes.forEach(u=>u?.parentNode?.removeChild(u));let l=t;for(let c of f){let u=i.get(c.key);u?(F(u.nodes,c.nodes,n),u.nodes[0]!==l.nextSibling&&n.insertBefore(d(u.nodes),l.nextSibling),c.nodes=u.nodes):n.insertBefore(d(c.nodes,{mark:!0}),l.nextSibling),l=c.nodes[c.nodes.length-1]||l}t._marker=f}r(G,"reconcile");function F(e,t,n){for(let o=0;o<Math.max(e.length,t.length);o++){let i=e[o],f=t[o];!i&&f?n.appendChild(f):i&&!f?(i._cleanup?.(),n.removeChild(i)):i&&f&&(i.nodeType!==f.nodeType||i.tagName!==f.tagName?n.replaceChild(f,i):i.nodeType===3?i.nodeValue!==f.nodeValue&&(i.nodeValue=f.nodeValue):i.nodeType===1&&(v(i,f),F([...i.childNodes],[...f.childNodes],i)))}}r(F,"patchNodes");function v(e,t){let n=new Set;for(let{name:o,value:i}of t.attributes)e.getAttribute(o)!==i&&e.setAttribute(o,i),n.add(o);for(let{name:o}of e.attributes)n.has(o)||e.removeAttribute(o)}r(v,"patchAttributes");var R=new WeakMap,y="\uFEFF",N=r((e,t,n)=>{if(t)if(e.removeAttribute(t),t==="ref")typeof n=="function"?n(e):n&&(n.current=e);else if(t[0]=="o"&&t[1]=="n"&&typeof n=="function"){let o=t.slice(2).toLowerCase();e.addEventListener(o,n),e._cleanup=()=>e.removeEventListener(o,n)}else t==="style"&&typeof n=="object"?a(()=>Object.assign(e.style,n)):a(()=>ee(e,t,typeof n=="function"?n():n));else ne(e,n)},"render");function ee(e,t,n){t==="value"||t==="checked"?e[t]=n:n===!1||n===null||n===void 0?e.removeAttribute(t):e.setAttribute(t,typeof n=="object"?U(n):n)}r(ee,"setAttribute");function te(e,t){let n=e.parentNode,o=e.nextSibling;for(;o&&o._marker;)o._cleanup?.(),n.removeChild(o),o=e.nextSibling;t?.length&&oe(d(t,{mark:!0}),n,e.nextSibling)}r(te,"replaceNodes");function ne(e,t){let n=r(o=>{if(typeof o=="boolean"&&(o=""),Array.isArray(o))G(o,e);else{let i=document.createTextNode(O(typeof o=="string"?o:String(o??"")));te(e,[i])}},"updateContent");typeof t=="function"?a(()=>n(t())):n(t)}r(ne,"setContent");function oe(e,t,n=null){!e||!t||(n&&n.parentNode===t?t.insertBefore(e,n):t.appendChild(e))}r(oe,"insertFragment");function re(e,t){let n=[],o=document.createTreeWalker(e.content,5);for(;o.nextNode();)n.push(o.currentNode);let i=0;for(let f=0;f<n.length;f++){let s=n[f];if(s.nodeType===1&&s.attributes.length)for(let l of Array.from(s.attributes))l.value===y&&N(s,l.name,t[i++]);else if(s.nodeType===3&&s.nodeValue.includes(y))if(s.nodeValue===y){let l=document.createComment("");s.parentNode.replaceChild(l,s),N(l,null,t[i++])}else{let l=x(s.nodeValue.replaceAll(y,"<!>")),c=Array.from(l.content.childNodes);for(let u=0;u<c.length;u++){let A=c[u];A.nodeType===8&&N(A,null,t[i++])}s.parentNode.replaceChild(l.content,s)}}}r(re,"processTemplate");var x=r((e,t)=>{let n=document.createElement("template");return n.innerHTML=e,t?.as==="nodes"?[...n.content.childNodes]:n},"createNodes"),j=r((e,...t)=>{let n=R.get(e)||(R.set(e,e),e);if(!t.length)return n.length===1?x(n[0],{as:"nodes"}):x(n.join(""),{as:"nodes"});let o=x(n.join(y));return re(o,t),[...o.content.childNodes]},"html");function B(e,t,n="error"){let o=n==="warn"?console.warn:console.error,i=t instanceof Error?t:new Error(String(t));return o(`[Esor Error] ${e}:`,i.message),i}r(B,"handleError");var E=null,D=r(e=>{E=e,e._lifecycles={beforeMount:[],mount:[],beforeUpdate:[],update:[],destroy:[]},e.runHook=t=>{let n=e._lifecycles?.[t];if(!(!n||!n.length))for(let o=0;o<n.length;o++)queueMicrotask(()=>n[o].call(e))}},"createLifecycle"),h=r((e,t)=>{if(!E||!E._lifecycles){B("lifecycle",`Hook called outside ctx setup for "${e}"`);return}E._lifecycles[e].push(t)},"addHook"),$=r(e=>h("beforeMount",e),"beforeMount"),W=r(e=>h("mount",e),"onMount"),q=r(e=>h("beforeUpdate",e),"beforeUpdate"),P=r(e=>h("update",e),"onUpdate"),X=r(e=>h("destroy",e),"onDestroy"),J=r(e=>{let t=e();return typeof t=="function"&&h("destroy",t),()=>{}},"onEffect");var ie=/^-?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/;function se(e){if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;if(ie.test(e))return Number(e);if(typeof e=="string"&&(e[0]==="{"||e[0]==="["))try{return JSON.parse(e)}catch{}return e}r(se,"parseAttributeValue");function K(e){for(let t of e.attributes){let{name:n,value:o}=t;n.startsWith("on")||n.startsWith("ref")||(e.props[n]=m(se(o)))}}r(K,"initializeProps");function Q(e){e&&(e.emit=(t,n)=>g(t,n,e))}r(Q,"initDispatch");var ce=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,fe=r((e,t={})=>{var n,o,i;return i=class extends HTMLElement{constructor(){super();M(this,n,this.attachShadow({mode:t.shadowMode||"open"}));M(this,o,!1);_(this,"props",Object.create(null));_(this,"_cleanup",[]);D(this),Q(this),K(this);let s=e?.call(this,this.props),l=typeof s=="function"?s():s;d(l||[l],{parent:C(this,n)}),this.runHook("beforeMount")}connectedCallback(){C(this,o)||(w(this,o,!0),this.runHook("mount"))}disconnectedCallback(){this.runHook("destroy"),this._cleanup.forEach(s=>s()),this._cleanup=[],w(this,o,!1)}},n=new WeakMap,o=new WeakMap,i},"BaseComponent"),I=r((e,t,n={})=>{typeof customElements<"u"&&ce.test(e)&&!customElements.get(e)&&customElements.define(e,fe(t,n))},"component");export{S as batch,$ as beforeMount,q as beforeUpdate,I as component,T as computed,a as effect,g as emit,j as html,X as onDestroy,J as onEffect,W as onMount,P as onUpdate,L as ref,m as signal};
//# sourceMappingURL=esor.min.js.map
