var $=Object.defineProperty;var O=e=>{throw TypeError(e)};var q=(e,t,n)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var A=(e,t,n)=>q(e,typeof t!="symbol"?t+"":t,n),I=(e,t,n)=>t.has(e)||O("Cannot "+n);var M=(e,t,n)=>(I(e,t,"read from private field"),n?n.call(e):t.get(e)),T=(e,t,n)=>t.has(e)?O("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var w=(e,t,n)=>(I(e,t,"access private method"),n);var C=null,N=0,h=null,L=!1;function z(){for(L=!1;h;){let e=h;h=null;for(let t of e)t()}}var D=e=>{let t=e,n=new Set;return(...r)=>{if(!r.length)return C&&n.add(C),t;let a=r[0];if(t!==a)if(t=a,N){h||(h=new Set);for(let c of n)h.add(c)}else{h||(h=new Set);for(let c of n)h.add(c);L||(L=!0,queueMicrotask(z))}return t}},x=e=>{let t=()=>{C=t,e(),C=null};return t(),t},G=e=>{let t=D(void 0);return x(()=>t(e())),t},K=e=>{N++;let t=e();return!--N&&h&&z(),t};var S=[],J=50,Y=()=>S.pop()||document.createElement("div"),Z=e=>{e.textContent="",e.innerHTML="",S.length<J&&S.push(e)};function P(e,t){let n=new Map,r=e.children;for(let c=0;c<r.length;c++){let u=r[c];u._key!==void 0&&n.set(u._key,u)}let a=[];for(let c=0;c<t.length;c++){let u=t[c],s=u._key,o=n.get(s),l=Y();b(l,u);let i=l.firstElementChild;o&&i?(g(o,i),a.push(o),n.delete(s)):i&&(i._key=s,a.push(i)),Z(l)}for(let c of n.values())c._cleanup?.(),e.removeChild(c);for(let c=0;c<a.length;c++){let u=a[c],s=r[c];s!==u&&e.insertBefore(u,s||null)}}function F(e,t){return e.nodeType===t.nodeType&&(e.nodeType!==1||e.tagName===t.tagName)}function Q(e,t,n){let r=t.length,a=n.length;if(r<20&&a<20){let l=Math.max(r,a);for(let i=0;i<l;i++){let m=t[i],f=n[i];m?f?g(m,f):(m._cleanup?.(),e.removeChild(m)):e.appendChild(f.cloneNode(!0))}return}let c=0;for(;c<r&&c<a&&F(t[c],n[c]);)g(t[c],n[c]),c++;let u=r-1,s=a-1;for(;u>=c&&s>=c&&F(t[u],n[s]);)g(t[u],n[s]),u--,s--;if(c>u&&c<=s){let l=n[s+1]?.nextSibling||null;for(let i=c;i<=s;i++)e.insertBefore(n[i].cloneNode(!0),l);return}if(c>s){for(let l=c;l<=u;l++)t[l]._cleanup?.(),e.removeChild(t[l]);return}let o=Math.max(u-c+1,s-c+1);for(let l=0;l<o;l++){let i=c+l,m=c+l,f=i<=u?t[i]:null,p=m<=s?n[m]:null;!f&&p?e.insertBefore(p.cloneNode(!0),t[i]||null):f&&!p?(f._cleanup?.(),e.removeChild(f)):f&&p&&g(f,p)}}function g(e,t){let n=e.nodeType,r=t.nodeType;if(n===1&&r===1){if(e.tagName!==t.tagName){e.replaceWith(t.cloneNode(!0));return}let a=e.attributes,c=t.attributes,u=[];for(let s=a.length-1;s>=0;s--){let{name:o}=a[s];!t.hasAttribute(o)&&u.push(o)}for(let s=0;s<c.length;s++){let{name:o,value:l}=c[s];o==="value"||o==="checked"?e[o]!==l&&(e[o]=l):e.getAttribute(o)!==l&&e.setAttribute(o,l)}for(let s=0;s<u.length;s++)e.removeAttribute(u[s]);Q(e,e.childNodes,t.childNodes)}else n===3&&r===3?e.textContent!==t.textContent&&(e.textContent=t.textContent):e.replaceWith(t.cloneNode(!0))}var k="\uFEFF",j=new WeakMap,y=new WeakMap,v=20,ee=(e,...t)=>{let n=j.get(e);if(!n){let l=document.createElement("template");l.innerHTML=e.join(k);let i=e.findIndex(m=>m.trim().endsWith("key="));n={template:l,keyAttrIndex:i},j.set(e,n)}let{template:r,keyAttrIndex:a}=n,c,u=[...t];a!==-1&&(c=t[a],u.splice(a,1));let s=u.some(l=>typeof l=="function"),o=u.length===0;return{template:r,values:u,_isTemplate:!0,_key:c,_isStatic:o,_hasReactiveValues:s}},H=(e,t,n=!0)=>{if(Array.isArray(t)){if(t.length&&t[0]?._key!==void 0){P(e,t);return}n&&!(e instanceof DocumentFragment)&&(e.textContent="");for(let r=0;r<t.length;r++){let a=document.createDocumentFragment();H(a,t[r],!1),e.appendChild(a)}return}n&&!(e instanceof DocumentFragment)&&(e.textContent=""),!(t==null||t===!1)&&(t._isTemplate?b(e,t):t instanceof Node?e.appendChild(t):e.appendChild(document.createTextNode(String(t))))},b=(e,{template:t,values:n,_isStatic:r,_hasReactiveValues:a})=>{if(r){let o=y.get(t);o?o=o.cloneNode(!0):(o=t.content.cloneNode(!0),y.size<v&&y.set(t,t.content.cloneNode(!0))),e.appendChild(o);return}if(!a&&y.size<v){let o=y.get(t);if(o){e.appendChild(o.cloneNode(!0));return}}let c=t.content.cloneNode(!0),u=0,s=o=>{if(o.nodeType===Node.TEXT_NODE&&o.nodeValue.includes(k)){let l=o.nodeValue.split(k),i=document.createDocumentFragment();for(let m=0;m<l.length;m++){if(m>0){let f=n[u++];if(typeof f=="function"){let p=document.createElement("span");i.appendChild(p),x(()=>H(p,f()))}else H(i,f,!1)}l[m]&&i.appendChild(document.createTextNode(l[m]))}o.parentNode.replaceChild(i,o)}else if(o.nodeType===Node.ELEMENT_NODE){let l=[];for(let i=0;i<o.attributes.length;i++){let m=o.attributes[i];m.name!=="key"&&m.value===k&&l.push(m)}for(let i=0;i<l.length;i++){let m=l[i],f=n[u++],p=m.name;if(o.removeAttribute(p),p==="ref")typeof f=="function"?f(o):f&&(f.current=o);else if(p==="style"&&f&&typeof f=="object")typeof f=="function"?x(()=>Object.assign(o.style,f())):Object.assign(o.style,f);else if(p[0]==="o"&&p[1]==="n"){let d=p.slice(2).toLowerCase();typeof f=="function"&&(o._cleanup?.(),o.addEventListener(d,f),o._cleanup=()=>o.removeEventListener(d,f))}else typeof f=="function"?o.tagName?.includes("-")?(o._functionProps||(o._functionProps={}),o._functionProps[p]=f):x(()=>{let d=f();p==="value"||p==="checked"||p==="selected"?o[p]=d:d==null||d===!1?o.removeAttribute(p):o.setAttribute(p,d===!0?"":d)}):p==="value"||p==="checked"||p==="selected"?o[p]=f:f==null||f===!1||o.setAttribute(p,f===!0?"":f)}o.hasAttribute("key")&&o.removeAttribute("key");for(let i=0;i<o.childNodes.length;i++)s(o.childNodes[i])}};for(let o=0;o<c.childNodes.length;o++)s(c.childNodes[o]);!a&&y.size<v&&y.set(t,c.cloneNode(!0)),e.appendChild(c)};var E=null,R=["beforeMount","mount","beforeUpdate","update","destroy"],U=e=>{E=e,e._lifecycles=Object.fromEntries(R.map(t=>[t,[]])),e.runHook=t=>{let n=e._lifecycles?.[t];n?.length&&queueMicrotask(()=>{for(let r=0;r<n.length;r++)n[r].call(e)})}},V=(e,t)=>{if(!E?._lifecycles)throw new Error(`[Esor] Hook called outside ctx setup for "${e}"`);E._lifecycles[e].push(t)},W={};R.forEach(e=>{let t=e.startsWith("before")?e:`on${e[0].toUpperCase()}${e.slice(1)}`;W[t]=n=>V(e,n)});var te=e=>{let t=e();return typeof t=="function"&&V("destroy",t),()=>{}},ne=()=>(!E&&console.warn("getCurrentContext called outside of component lifecycle"),E),{beforeMount:oe,onMount:ce,beforeUpdate:re,onUpdate:se,onDestroy:ie}=W;var le=e=>{if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;let t=e[0];if(t==="-"||t>="0"&&t<="9"){let n=+e;if(n===n)return n}if(t==="{"||t==="[")try{return JSON.parse(e)}catch{}return e},B=e=>{e._functionProps&&Object.assign(e.props,e._functionProps);let t=e.attributes;for(let n=0;n<t.length;n++){let{name:r,value:a}=t[n],c=r[0],u=r[1];c==="o"&&u==="n"||c==="r"&&u==="e"&&r[2]==="f"||a==="function"&&e._functionProps?.[r]||(e.props[r]=le(a))}};var _=()=>_.cache||(_.cache=[...document.querySelectorAll("head style, head link[rel=stylesheet]")]);var fe=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,ue=(e,t={})=>{var n,r,X,c;return c=class extends HTMLElement{constructor(){super();T(this,r);T(this,n,this.attachShadow({mode:t.shadowMode||"open"}));A(this,"props",Object.create(null));A(this,"_cleanup",[]);w(this,r,X).call(this),this.runHook("beforeMount")}connectedCallback(){this.runHook("mount")}disconnectedCallback(){this._cleanup.forEach(s=>s()),this._cleanup=[],this.runHook("destroy")}},n=new WeakMap,r=new WeakSet,X=function(){U(this),B(this),t.globalStyles&&_().forEach(o=>M(this,n).appendChild(o.cloneNode(!0)));let s=e?.call(this,this.props);b(M(this,n),s)},c},ae=(e,t,n={})=>{typeof customElements<"u"&&fe.test(e)&&!customElements.get(e)&&customElements.define(e,ue(t,n))};function pe(e=null){let t=e;return(...n)=>n.length===0?t:t=n[0]}function me(e,t,n=null){let r=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n?.dispatchEvent(r),r}export{K as batch,oe as beforeMount,re as beforeUpdate,ae as component,G as computed,x as effect,me as emit,ne as getCurrentContext,ee as html,ie as onDestroy,te as onEffect,ce as onMount,se as onUpdate,pe as ref,D as signal};
//# sourceMappingURL=esor.min.js.map
