var j=Object.defineProperty;var F=e=>{throw TypeError(e)};var ne=(e,t,n)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var r=(e,t)=>j(e,"name",{value:t,configurable:!0});var M=(e,t,n)=>ne(e,typeof t!="symbol"?t+"":t,n),z=(e,t,n)=>t.has(e)||F("Cannot "+n);var A=(e,t,n)=>(z(e,t,"read from private field"),n?n.call(e):t.get(e)),C=(e,t,n)=>t.has(e)?F("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),T=(e,t,n,o)=>(z(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var a=null,x=0,S=new Set,y=r(e=>{let t=e,n=[],o=r(i=>{if(i===void 0)return a&&!n.includes(a)&&(n.push(a),a.subs&&a.subs.add(o)),t;let u=typeof i=="function"?i(t):i;if(!Object.is(u,t))if(t=u,x>0)for(let c=0;c<n.length;c++)S.add(n[c]);else{let c=n.slice();for(let f=0;f<c.length;f++)c[f]()}return t},"getterSetter");return o.subs=n,o},"signal"),m=r(e=>{let t=new Set,n=!1,o=r(()=>{if(n)return;n=!0;let i=a;a=o;try{e()}finally{a=i,n=!1}},"reactive");return o.subs=t,o(),()=>{t.forEach(i=>{let u=i.subs.indexOf(o);u!==-1&&i.subs.splice(u,1)}),t.clear()}},"effect"),k=r(e=>{let t=y(e());return m(()=>t(e())),()=>t()},"computed"),w=r(e=>{x++;try{return e()}finally{if(x--,x===0){let t=Array.from(S);S.clear(),t.forEach(n=>n())}}},"batch");function _(e,t,n=null){let o=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n&&n.dispatchEvent(o),o}r(_,"emit");function U(e=null){let t=e;return n=>n!==void 0?t=n:t}r(U,"ref");var W=r(e=>e==null?"":String(e).replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[t]),"sanitizeHtml");function d(e,{mark:t=!1,parent:n=null}={}){let o=document.createDocumentFragment();if(!e?.length)return o;for(let i of e)i&&(t&&i&&(i.__nodeGroups=!0),Array.isArray(i)?o.appendChild(d(i,{mark:t})):o.appendChild(i));return n&&o.childNodes.length&&n.appendChild(o),o}r(d,"createFragment");function B(e,t){if(!e||!t||!t.parentNode)return;let n=t.parentNode,o=r(s=>{for(let l of s)!l||l.parentNode!==n||(l._cleanup&&typeof l._cleanup=="function"&&l._cleanup(),n.removeChild(l))},"removeNodes"),i=r((s,l)=>s.length!==l.length||s.some((h,L)=>!h.isEqualNode(l[L])),"nodesChanged"),u=t.__nodeGroups||[],c=new Map(u.map(s=>[s.key,s])),f=e.map((s,l)=>{let h=Array.isArray(s)?s.filter(Boolean):[s];return{key:h.find(te=>te?.getAttribute?.("key")!=null)?.getAttribute("key")||`__key_${l}`,nodes:h}}),E=new Map(f.map(s=>[s.key,s]));for(let s of u)!E.has(s.key)&&o(s.nodes);let p=t;for(let s of f){let l=c.get(s.key);if(l)if(i(l.nodes,s.nodes))o(l.nodes),n.insertBefore(d(s.nodes,{mark:!0}),p.nextSibling);else{let h=p.nextSibling;l.nodes[0]!==h&&n.insertBefore(d(l.nodes),h),s.nodes=l.nodes}else n.insertBefore(d(s.nodes,{mark:!0}),p.nextSibling);p=s.nodes[s.nodes.length-1]||p}t.__nodeGroups=f}r(B,"reconcile");var O=new WeakMap,g="\uFEFF",H=r((e,t,n)=>{if(t)if(e.removeAttribute(t),t==="ref")typeof n=="function"?n(e):n&&(n.current=e);else if(t[0]=="o"&&t[1]=="n"&&typeof n=="function"){let o=t.slice(2).toLowerCase();e.addEventListener(o,n),e._cleanup=()=>e.removeEventListener(o,n)}else t==="style"&&typeof n=="object"?m(()=>Object.assign(e.style,n)):typeof n=="function"?m(()=>R(e,t,n())):R(e,t,n);else re(e,n)},"render");function R(e,t,n){t==="value"||t==="checked"?e[t]=n:n===!1||n===null||n===void 0?e.removeAttribute(t):e.setAttribute(t,n)}r(R,"setAttribute");function oe(e,t){let n=e.parentNode,o=e.nextSibling;for(;o&&o.__nodeGroups;)o._cleanup&&o._cleanup(),n.removeChild(o),o=e.nextSibling;t?.length&&ie(d(t,{mark:!0}),n,e.nextSibling)}r(oe,"replaceNodes");function re(e,t){let n=r(o=>{if(typeof o=="boolean"&&(o=""),Array.isArray(o))B(o,e);else{let i=document.createTextNode(W(typeof o=="string"?o:String(o??"")));oe(e,[i])}},"updateContent");typeof t=="function"?m(()=>n(t())):n(t)}r(re,"setContent");function ie(e,t,n=null){!e||!t||(n&&n.parentNode===t?t.insertBefore(e,n):t.appendChild(e))}r(ie,"insertFragment");function D(e){let t=document.createElement("template");return t.innerHTML=e,t}r(D,"createTemplate");function se(e,t){let n=[],o=document.createTreeWalker(e.content,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);for(;o.nextNode();)n.push(o.currentNode);let i=0;for(let u=0;u<n.length;u++){let c=n[u];if(c.nodeType===Node.ELEMENT_NODE&&c.attributes.length)for(let f of Array.from(c.attributes))f.value===g&&H(c,f.name,t[i++]);else if(c.nodeType===Node.TEXT_NODE&&c.nodeValue.includes(g))if(c.nodeValue===g){let f=document.createComment("");c.parentNode.replaceChild(f,c),H(f,null,t[i++])}else{let f=D(c.nodeValue.replaceAll(g,"<!>")),E=Array.from(f.content.childNodes);for(let p=0;p<E.length;p++){let s=E[p];s.nodeType===Node.COMMENT_NODE&&H(s,null,t[i++])}c.parentNode.replaceChild(f.content,c)}}}r(se,"processTemplate");function V(e,t=null){let n=D(e);return typeof t=="function"&&t(n),[...n.content.childNodes]}r(V,"templateToNodes");function $(e,...t){if(e.length===1)return V(e[0]);if(!t.length)return V(e.join(""));let n=e.join(g),o=D(n);return se(o,t),[...o.content.childNodes]}r($,"build");function G(e,...t){return O.has(e)?$(O.get(e),...t):(O.set(e,e),$(e,...t))}r(G,"html");function X(e,t,n="error"){let o=n==="warn"?console.warn:console.error,i=t instanceof Error?t:new Error(String(t));return o(`[Esor Error] ${e}:`,i.message),i}r(X,"handleError");var N=null,q=r(e=>{N=e,e._lifecycles={beforeMount:[],mount:[],beforeUpdate:[],update:[],destroy:[]},e.runHook=t=>{let n=e._lifecycles?.[t];if(!(!n||!n.length))for(let o=0;o<n.length;o++)queueMicrotask(()=>n[o].call(e))}},"createLifecycle"),b=r((e,t)=>{if(!N||!N._lifecycles){X("lifecycle",`Hook called outside ctx setup for "${e}"`);return}N._lifecycles[e].push(t)},"addHook"),P=r(e=>b("beforeMount",e),"beforeMount"),J=r(e=>b("mount",e),"onMount"),K=r(e=>b("beforeUpdate",e),"beforeUpdate"),I=r(e=>b("update",e),"onUpdate"),Q=r(e=>b("destroy",e),"onDestroy"),Y=r(e=>{let t=e();return typeof t=="function"&&b("destroy",t),()=>{}},"onEffect");var ce=/^-?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/;function fe(e){if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;if(ce.test(e))return Number(e);if(typeof e=="string"&&(e[0]==="{"||e[0]==="["))try{return JSON.parse(e)}catch{}return e}r(fe,"parseAttributeValue");function Z(e){for(let t of e.attributes){let{name:n,value:o}=t;n.startsWith("on")||n.startsWith("ref")||(e.props[n]=y(fe(o)))}}r(Z,"initializeProps");function v(e){e&&(e.emit=(t,n)=>_(t,n,e))}r(v,"initDispatch");var le=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,ue="open",pe=r((e,t={})=>{var n,o,i;return i=class extends HTMLElement{constructor(){super();C(this,n,this.attachShadow({mode:t.mode||ue}));C(this,o,!1);M(this,"props",Object.create(null));M(this,"_cleanup",[]);q(this),v(this),Z(this);let c=e?.call(this,this.props),f=typeof c=="function"?c():c;d(f||[f],{parent:A(this,n)}),this.runHook("beforeMount")}connectedCallback(){A(this,o)||(T(this,o,!0),this.runHook("mount"))}disconnectedCallback(){this.runHook("destroy"),this._cleanup.forEach(c=>c()),this._cleanup=[],T(this,o,!1)}},n=new WeakMap,o=new WeakMap,i},"BaseComponent"),ee=r((e,t,n={})=>{typeof customElements<"u"&&le.test(e)&&!customElements.get(e)&&customElements.define(e,pe(t,n))},"component");export{w as batch,P as beforeMount,K as beforeUpdate,ee as component,k as computed,m as effect,_ as emit,G as html,Q as onDestroy,Y as onEffect,J as onMount,I as onUpdate,U as ref,y as signal};
//# sourceMappingURL=esor.min.js.map
