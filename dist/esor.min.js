var H=Object.defineProperty;var O=e=>{throw TypeError(e)};var B=(e,t,n)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var s=(e,t)=>H(e,"name",{value:t,configurable:!0});var _=(e,t,n)=>B(e,typeof t!="symbol"?t+"":t,n),D=(e,t,n)=>t.has(e)||O("Cannot "+n);var A=(e,t,n)=>(D(e,t,"read from private field"),n?n.call(e):t.get(e)),T=(e,t,n)=>t.has(e)?O("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var F=(e,t,n)=>(D(e,t,"access private method"),n);var E=null,M=0,b=null,L=s(e=>{let t=e,n=new Set;return(...r)=>{if(!r.length)return E&&n.add(E),t;let a=r[0];if(t!==a)if(t=a,M){b||(b=new Set);for(let c of n)b.add(c)}else for(let c of n)c();return t}},"signal"),y=s(e=>{let t=s(()=>{E=t,e(),E=null},"execute");return t(),t},"effect"),P=s(e=>{let t=L(void 0);return y(()=>t(e())),t},"computed"),S=s(e=>{M++;let t=e();if(!--M&&b){let n=b;b=null;for(let r of n)r()}return t},"batch");var w=[],G=s(()=>w.pop()||document.createElement("div"),"getContainer"),K=s(e=>{e.textContent="",w.length<10&&w.push(e)},"releaseContainer");function N(e,t){let n=new Map,r=e.children;for(let c=0;c<r.length;c++){let o=r[c];o._key!==void 0&&n.set(o._key,o)}let a=[];for(let c=0;c<t.length;c++){let o=t[c],u=o._key,i=n.get(u),m=G();x(m,o);let l=m.firstElementChild;i&&l?(j(i,l),a.push(i),n.delete(u)):l&&(l._key=u,a.push(l)),K(m)}for(let c of n.values())c._cleanup?.(),e.removeChild(c);for(let c=0;c<a.length;c++){let o=a[c],u=r[c];u!==o&&e.insertBefore(o,u||null)}}s(N,"reconcileArray");function j(e,t){let n=e.nodeType,r=t.nodeType;if(n===1&&r===1){if(e.tagName!==t.tagName){e.replaceWith(t.cloneNode(!0));return}let a=e.attributes,c=t.attributes,o=[];for(let f=a.length-1;f>=0;f--){let{name:h}=a[f];!t.hasAttribute(h)&&o.push(h)}for(let f=0;f<c.length;f++){let{name:h,value:d}=c[f];h==="value"||h==="checked"?e[h]!==d&&(e[h]=d):e.getAttribute(h)!==d&&e.setAttribute(h,d)}for(let f=0;f<o.length;f++)e.removeAttribute(o[f]);let u=e.childNodes,i=t.childNodes,m=u.length,l=i.length,p=Math.max(m,l);for(let f=0;f<p;f++){let h=u[f],d=i[f];h?d?j(h,d):(h._cleanup?.(),e.removeChild(h)):e.appendChild(d.cloneNode(!0))}}else n===3&&r===3?e.textContent!==t.textContent&&(e.textContent=t.textContent):e.replaceWith(t.cloneNode(!0))}s(j,"patchNode");var k="\uFEFF",z=new WeakMap,U=s((e,...t)=>{let n=z.get(e);if(!n){let u=document.createElement("template");u.innerHTML=e.join(k);let i=e.findIndex(m=>m.trim().endsWith("key="));n={template:u,keyAttrIndex:i},z.set(e,n)}let{template:r,keyAttrIndex:a}=n,c,o=[...t];return a!==-1&&(c=t[a],o.splice(a,1)),{template:r,values:o,_isTemplate:!0,_key:c}},"html"),v=s((e,t,n=!0)=>{if(Array.isArray(t)){if(t.length&&t[0]?._key!==void 0){N(e,t);return}n&&!(e instanceof DocumentFragment)&&(e.textContent="");for(let r=0;r<t.length;r++){let a=document.createDocumentFragment();v(a,t[r],!1),e.appendChild(a)}return}n&&!(e instanceof DocumentFragment)&&(e.textContent=""),!(t==null||t===!1)&&(t._isTemplate?x(e,t):t instanceof Node?e.appendChild(t):e.appendChild(document.createTextNode(String(t))))},"renderValue"),x=s((e,{template:t,values:n})=>{let r=t.content.cloneNode(!0),a=0,c=s(o=>{if(o.nodeType===Node.TEXT_NODE&&o.nodeValue.includes(k)){let u=o.nodeValue.split(k),i=document.createDocumentFragment();for(let m=0;m<u.length;m++){if(m>0){let l=n[a++];if(typeof l=="function"){let p=document.createElement("span");i.appendChild(p),y(()=>v(p,l()))}else v(i,l,!1)}u[m]&&i.appendChild(document.createTextNode(u[m]))}o.parentNode.replaceChild(i,o)}else if(o.nodeType===Node.ELEMENT_NODE){let u=[];for(let i=0;i<o.attributes.length;i++){let m=o.attributes[i];m.name!=="key"&&m.value===k&&u.push(m)}for(let i=0;i<u.length;i++){let m=u[i],l=n[a++],p=m.name;if(o.removeAttribute(p),p==="ref")typeof l=="function"?l(o):l&&(l.current=o);else if(p==="style"&&l&&typeof l=="object")typeof l=="function"?y(()=>Object.assign(o.style,l())):Object.assign(o.style,l);else if(p[0]==="o"&&p[1]==="n"){let f=p.slice(2).toLowerCase();typeof l=="function"&&(o._cleanup?.(),o.addEventListener(f,l),o._cleanup=()=>o.removeEventListener(f,l))}else typeof l=="function"?o.tagName?.includes("-")?(o._functionProps||(o._functionProps={}),o._functionProps[p]=l):y(()=>{let f=l();p==="value"||p==="checked"||p==="selected"?o[p]=f:f==null||f===!1?o.removeAttribute(p):o.setAttribute(p,f===!0?"":f)}):p==="value"||p==="checked"||p==="selected"?o[p]=l:l==null||l===!1||o.setAttribute(p,l===!0?"":l)}o.hasAttribute("key")&&o.removeAttribute("key");for(let i=0;i<o.childNodes.length;i++)c(o.childNodes[i])}},"processNode");for(let o=0;o<r.childNodes.length;o++)c(r.childNodes[o]);e.appendChild(r)},"renderTemplate");var C=null,I=["beforeMount","mount","beforeUpdate","update","destroy"],R=s(e=>{C=e,e._lifecycles=Object.fromEntries(I.map(t=>[t,[]])),e.runHook=t=>{let n=e._lifecycles?.[t];n?.length&&queueMicrotask(()=>{for(let r=0;r<n.length;r++)n[r].call(e)})}},"createLifecycle"),V=s((e,t)=>{if(!C?._lifecycles)throw new Error(`[Esor] Hook called outside ctx setup for "${e}"`);C._lifecycles[e].push(t)},"addHook"),W={};I.forEach(e=>{let t=e.startsWith("before")?e:`on${e[0].toUpperCase()}${e.slice(1)}`;W[t]=n=>V(e,n)});var X=s(e=>{let t=e();return typeof t=="function"&&V("destroy",t),()=>{}},"onEffect"),J=s(()=>(!C&&console.warn("getCurrentContext called outside of component lifecycle"),C),"getCurrentContext"),{beforeMount:Y,onMount:Q,beforeUpdate:Z,onUpdate:ee,onDestroy:te}=W;var ne=s(e=>{if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;let t=e[0];if(t==="-"||t>="0"&&t<="9"){let n=+e;if(n===n)return n}if(t==="{"||t==="[")try{return JSON.parse(e)}catch{}return e},"parseAttributeValue"),$=s(e=>{e._functionProps&&Object.assign(e.props,e._functionProps);let t=e.attributes;for(let n=0;n<t.length;n++){let{name:r,value:a}=t[n],c=r[0],o=r[1];c==="o"&&o==="n"||c==="r"&&o==="e"&&r[2]==="f"||a==="function"&&e._functionProps?.[r]||(e.props[r]=ne(a))}},"initializeProps");var g=s(()=>g.cache||(g.cache=[...document.querySelectorAll("head style, head link[rel=stylesheet]")]),"s");var oe=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,re=s((e,t={})=>{var n,r,q,c;return c=class extends HTMLElement{constructor(){super();T(this,r);T(this,n,this.attachShadow({mode:t.shadowMode||"open"}));_(this,"props",Object.create(null));_(this,"_cleanup",[]);F(this,r,q).call(this),this.runHook("beforeMount")}connectedCallback(){this.runHook("mount")}disconnectedCallback(){this._cleanup.forEach(u=>u()),this._cleanup=[],this.runHook("destroy")}},n=new WeakMap,r=new WeakSet,q=s(function(){R(this),$(this),t.globalStyles&&g().forEach(i=>A(this,n).appendChild(i.cloneNode(!0)));let u=e?.call(this,this.props);x(A(this,n),u)},"#initializeComponent"),c},"BaseComponent"),ce=s((e,t,n={})=>{typeof customElements<"u"&&oe.test(e)&&!customElements.get(e)&&customElements.define(e,re(t,n))},"component");function se(e=null){let t=e;return(...n)=>n.length===0?t:t=n[0]}s(se,"ref");function le(e,t,n=null){let r=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n?.dispatchEvent(r),r}s(le,"emit");export{S as batch,Y as beforeMount,Z as beforeUpdate,ce as component,P as computed,y as effect,le as emit,J as getCurrentContext,U as html,te as onDestroy,X as onEffect,Q as onMount,ee as onUpdate,se as ref,L as signal};
//# sourceMappingURL=esor.min.js.map
