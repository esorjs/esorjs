var M=Object.defineProperty;var N=e=>{throw TypeError(e)};var V=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var r=(e,t)=>M(e,"name",{value:t,configurable:!0});var x=(e,t,n)=>V(e,typeof t!="symbol"?t+"":t,n),O=(e,t,n)=>t.has(e)||N("Cannot "+n);var C=(e,t,n)=>(O(e,t,"read from private field"),n?n.call(e):t.get(e)),_=(e,t,n)=>t.has(e)?N("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var L=(e,t,n)=>(O(e,t,"access private method"),n);var E=null,k=0,A=r(e=>{let t=e,n=new Set;return(...s)=>{if(s.length===0)return E&&n.add(E),t;let i=s[0];if(t!==i&&(t=i,k===0))for(let u of n)u();return t}},"signal"),m=r(e=>{let t=r(()=>{E=t,e(),E=null},"execute");return t(),t},"effect"),D=r(e=>{let t=A(void 0);return m(()=>t(e())),t},"computed"),w=r(e=>{k++;let t=e();return--k,t},"batch");function T(e,t){let n=new Map;for(let i of e.children)i._key!==void 0&&n.set(i._key,i);let s=[];for(let i of t){let u=i._key,o=n.get(u),l=document.createElement("div");d(l,i);let c=l.firstElementChild;o&&c?(H(o,c),s.push(o),n.delete(u)):c&&(c._key=u,s.push(c))}for(let i of n.values())i._cleanup?.(),e.removeChild(i);for(let i=0;i<s.length;i++){let u=s[i],o=e.children[i];o!==u&&e.insertBefore(u,o||null)}}r(T,"reconcileArray");function H(e,t){if(e.nodeType===Node.ELEMENT_NODE&&t.nodeType===Node.ELEMENT_NODE){if(e.tagName!==t.tagName){e.replaceWith(t.cloneNode(!0));return}let n=new Map;for(let{name:o,value:l}of e.attributes)n.set(o,l);for(let{name:o,value:l}of t.attributes)o==="value"||o==="checked"?e[o]!==l&&(e[o]=l):e.getAttribute(o)!==l&&e.setAttribute(o,l),n.delete(o);for(let o of n.keys())e.removeAttribute(o);let s=Array.from(e.childNodes),i=Array.from(t.childNodes),u=Math.max(s.length,i.length);for(let o=0;o<u;o++){let l=s[o],c=i[o];l?c?H(l,c):(l._cleanup?.(),e.removeChild(l)):e.appendChild(c.cloneNode(!0))}}else e.nodeType===Node.TEXT_NODE&&t.nodeType===Node.TEXT_NODE?e.textContent!==t.textContent&&(e.textContent=t.textContent):e.replaceWith(t.cloneNode(!0))}r(H,"patchNode");var b="\uFEFF",W=new WeakMap,j=r((e,...t)=>{let n=W.get(e);if(!n){let l=document.createElement("template");l.innerHTML=e.join(b);let c=e.findIndex(f=>f.trim().endsWith("key="));n={template:l,keyAttrIndex:c},W.set(e,n)}let{template:s,keyAttrIndex:i}=n,u,o=[...t];return i!==-1&&(u=t[i],o.splice(i,1)),{template:s,values:o,_isTemplate:!0,_key:u}},"html"),g=r((e,t)=>{if(Array.isArray(t)&&t.length>0&&t[0]?._key!==void 0){T(e,t);return}for(;e.firstChild;)e.removeChild(e.firstChild);t==null||t===!1||(t._isTemplate?d(e,t):Array.isArray(t)?t.forEach(n=>{let s=document.createDocumentFragment();g(s,n),e.appendChild(s)}):t instanceof Node?e.appendChild(t):e.appendChild(document.createTextNode(String(t))))},"renderValue"),d=r((e,{template:t,values:n})=>{let s=t.content.cloneNode(!0),i=0,u=r(o=>{if(o.nodeType===Node.TEXT_NODE&&o.nodeValue.includes(b)){let l=o.nodeValue.split(b),c=document.createDocumentFragment();for(let f=0;f<l.length;f++){if(f>0){let a=n[i++];if(typeof a=="function"){let p=document.createElement("span");c.appendChild(p),m(()=>g(p,a()))}else g(c,a)}l[f]&&c.appendChild(document.createTextNode(l[f]))}o.parentNode.replaceChild(c,o)}else o.nodeType===Node.ELEMENT_NODE&&([...o.attributes].filter(c=>c.name!=="key"&&c.value===b).forEach(c=>{let f=n[i++];if(o.removeAttribute(c.name),c.name==="ref")typeof f=="function"?f(o):f.current=o;else if(c.name==="style"&&typeof f=="object"&&f!==null)typeof f=="function"?m(()=>Object.assign(o.style,f())):Object.assign(o.style,f);else if(typeof f=="function"&&o.tagName?.includes("-"))o._functionProps||(o._functionProps={}),o._functionProps[c.name]=f;else if(c.name.startsWith("on")){let a=c.name.slice(2).toLowerCase();typeof f=="function"&&(o.addEventListener(a,f),o._cleanup=()=>o.removeEventListener(a,f))}else{let a=r(p=>{["value","checked","selected"].includes(c.name)?o[c.name]=p:p==null||p===!1?o.removeAttribute(c.name):o.setAttribute(c.name,p===!0?"":p)},"setAttribute");typeof f=="function"?m(()=>a(f())):a(f)}}),o.hasAttribute("key")&&o.removeAttribute("key"),[...o.childNodes].forEach(u))},"processNode");[...s.childNodes].forEach(u),e.appendChild(s)},"renderTemplate");var h=null,P=["beforeMount","mount","beforeUpdate","update","destroy"],z=r(e=>{h=e,e._lifecycles=Object.fromEntries(P.map(t=>[t,[]])),e.runHook=t=>{let n=e._lifecycles?.[t];n?.length&&n.forEach(s=>queueMicrotask(()=>s.call(e)))}},"createLifecycle"),S=r((e,t)=>{if(!h?._lifecycles)throw new Error(`[Esor] Hook called outside ctx setup for "${e}"`);h._lifecycles[e].push(t)},"addHook"),U={};P.forEach(e=>{let t=e.startsWith("before")?e:`on${e[0].toUpperCase()}${e.slice(1)}`;U[t]=n=>S(e,n)});var X=r(e=>{let t=e();return typeof t=="function"&&S("destroy",t),()=>{}},"onEffect"),$=r(()=>(!h&&console.warn("getCurrentContext called outside of component lifecycle"),h),"getCurrentContext"),{beforeMount:R,onMount:G,beforeUpdate:q,onUpdate:B,onDestroy:K}=U;var v=/^-?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/,J=r(e=>{if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;if(v.test(e))return Number(e);if(typeof e=="string"&&(e[0]==="{"||e[0]==="["))try{return JSON.parse(e)}catch{}return e},"parseAttributeValue"),F=r(e=>{e._functionProps&&Object.assign(e.props,e._functionProps);for(let{name:t,value:n}of e.attributes)t.startsWith("on")||t.startsWith("ref")||n==="function"&&e._functionProps?.[t]||(e.props[t]=J(n))},"initializeProps");var y=r(()=>y.cache||(y.cache=[...document.querySelectorAll("head style, head link[rel=stylesheet]")]),"s");var Y=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,Q=r((e,t={})=>{var n,s,I,u;return u=class extends HTMLElement{constructor(){super();_(this,s);_(this,n,this.attachShadow({mode:t.shadowMode||"open"}));x(this,"props",Object.create(null));x(this,"_cleanup",[]);L(this,s,I).call(this),this.runHook("beforeMount")}connectedCallback(){this.runHook("mount")}disconnectedCallback(){this._cleanup.forEach(l=>l()),this._cleanup=[],this.runHook("destroy")}},n=new WeakMap,s=new WeakSet,I=r(function(){z(this),F(this),t.gobalStyles&&y().forEach(c=>C(this,n).appendChild(c.cloneNode(!0)));let l=e?.call(this,this.props);d(C(this,n),l)},"#initializeComponent"),u},"BaseComponent"),Z=r((e,t,n={})=>{typeof customElements<"u"&&Y.test(e)&&!customElements.get(e)&&customElements.define(e,Q(t,n))},"component");function ee(e=null){let t=e;return(...n)=>n.length===0?t:t=n[0]}r(ee,"ref");function te(e,t,n=null){let s=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n?.dispatchEvent(s),s}r(te,"emit");export{w as batch,R as beforeMount,q as beforeUpdate,Z as component,D as computed,m as effect,te as emit,$ as getCurrentContext,j as html,K as onDestroy,X as onEffect,G as onMount,B as onUpdate,ee as ref,A as signal};
//# sourceMappingURL=esor.min.js.map
