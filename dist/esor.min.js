var T=Object.defineProperty;var k=e=>{throw TypeError(e)};var P=(e,t,n)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var s=(e,t)=>T(e,"name",{value:t,configurable:!0});var E=(e,t,n)=>P(e,typeof t!="symbol"?t+"":t,n),N=(e,t,n)=>t.has(e)||k("Cannot "+n);var A=(e,t,n)=>(N(e,t,"read from private field"),n?n.call(e):t.get(e)),C=(e,t,n)=>t.has(e)?k("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),_=(e,t,n,o)=>(N(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);function j(e,t,n="error"){let o=n==="warn"?console.warn:console.error,r=t instanceof Error?t:new Error(String(t));return o(`[Esor Error] ${e}:`,r.message),r}s(j,"handleError");var y=null,H=["beforeMount","mount","beforeUpdate","update","destroy"],L=s(e=>{y=e,e._lifecycles=Object.fromEntries(H.map(t=>[t,[]])),e.runHook=t=>{let n=e._lifecycles?.[t];if(n?.length)for(let o=0;o<n.length;o++)queueMicrotask(()=>n[o].call(e))}},"createLifecycle"),O=s((e,t)=>{if(!y||!y._lifecycles){j("lifecycle",`Hook called outside ctx setup for "${e}"`);return}y._lifecycles[e].push(t)},"addHook"),V={};H.forEach(e=>{let t=e.startsWith("before")?e:`on${e.charAt(0).toUpperCase()+e.slice(1)}`;V[t]=n=>O(e,n)});var{beforeMount:X,onMount:I,beforeUpdate:J,onUpdate:Q,onDestroy:Y}=V,Z=s(e=>{let t=e();return typeof t=="function"&&O("destroy",t),()=>{}},"onEffect");var p=null,b=0,w=new Set,m=s(e=>{let t=e,n=[],o=s(r=>{if(r===void 0)return p&&!n.includes(p)&&(n.push(p),p.subs&&p.subs.add(o)),t;let c=typeof r=="function"?r(t):r;if(!Object.is(c,t))if(t=c,b>0)for(let i=0;i<n.length;i++)w.add(n[i]);else{let i=n.slice();for(let l=0;l<i.length;l++)i[l]()}return t},"getterSetter");return o.subs=n,o},"signal"),d=s(e=>{let t=new Set,n=!1,o=s(()=>{if(n)return;n=!0;let r=p;p=o;try{e()}finally{p=r,n=!1}},"reactive");return o.subs=t,o(),()=>{t.forEach(r=>{let c=r.subs.indexOf(o);c!==-1&&r.subs.splice(c,1)}),t.clear()}},"effect"),z=s(e=>{let t=m(e());return d(()=>t(e())),()=>t()},"computed"),F=s(e=>{b++;try{return e()}finally{if(b--,b===0){let t=Array.from(w);w.clear(),t.forEach(n=>n())}}},"batch");var v=/^-?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/;function ee(e){if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;if(v.test(e))return Number(e);if(typeof e=="string"&&(e[0]==="{"||e[0]==="["))try{return JSON.parse(e)}catch{}return e}s(ee,"parseAttributeValue");function U(e){for(let t of e.attributes){let{name:n,value:o}=t;n.startsWith("on")||n.startsWith("ref")||(e.props[n]=m(ee(o)))}}s(U,"initializeProps");function M(e,t,n=null){let o=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n?.dispatchEvent(o),o}s(M,"emit");function G(e){e&&(e.emit=(t,n)=>M(t,n,e))}s(G,"initDispatch");function a(e,{mark:t=!1,parent:n=null}={}){let o=document.createDocumentFragment();if(!e?.length)return o;for(let r of e)r&&(t&&(r._marker=!0),o.appendChild(Array.isArray(r)?a(r,{mark:t}):r));return n&&o.childNodes.length&&n.appendChild(o),o}s(a,"createFragment");function R(e){return Object.keys(e).reduce((t,n)=>e[n]?t+n+" ":t,"").trim()}s(R,"joinTruthy");var te=/^[a-z][a-z0-9]*-[a-z0-9-]*$/,ne=s((e,t={})=>{var n,o,r;return r=class extends HTMLElement{constructor(){super();C(this,n,this.attachShadow({mode:t.shadowMode||"open"}));C(this,o,!1);E(this,"props",Object.create(null));E(this,"_cleanup",[]);L(this),G(this),U(this);let i=e?.call(this,this.props),l=typeof i=="function"?i():i;a(l||[l],{parent:A(this,n)}),this.runHook("beforeMount")}connectedCallback(){A(this,o)||(_(this,o,!0),this.runHook("mount"))}disconnectedCallback(){this.runHook("destroy"),this._cleanup.forEach(i=>i()),this._cleanup=[],_(this,o,!1)}},n=new WeakMap,o=new WeakMap,r},"BaseComponent"),oe=s((e,t,n={})=>{typeof customElements<"u"&&te.test(e)&&!customElements.get(e)&&customElements.define(e,ne(t,n))},"component");var $=s(e=>e==null?"":String(e).replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[t]),"sanitizeHtml");function D(e,t){if(!t?.parentNode)return;let n=t.parentNode,o=t._marker||[];if(!e?.length){for(let f of o)f.nodes.forEach(u=>u?.parentNode?.removeChild(u));t._marker=[];return}let r=new Map(o.map(f=>[f.key,f])),c=e.map((f,u)=>(f=Array.isArray(f)?f.filter(Boolean):[f],{key:f.find(K=>K?.getAttribute?.("key"))?.getAttribute("key")||`__index_${u}`,nodes:f})),i=new Map(c.map(f=>[f.key,f]));for(let f of o)i.has(f.key)||f.nodes.forEach(u=>u?.parentNode?.removeChild(u));let l=t;for(let f of c){let u=r.get(f.key);u?(B(u.nodes,f.nodes,n),u.nodes[0]!==l.nextSibling&&n.insertBefore(a(u.nodes),l.nextSibling),f.nodes=u.nodes):n.insertBefore(a(f.nodes,{mark:!0}),l.nextSibling),l=f.nodes[f.nodes.length-1]||l}t._marker=c}s(D,"reconcile");function B(e,t,n){for(let o=0;o<Math.max(e.length,t.length);o++){let r=e[o],c=t[o];!r&&c?n.appendChild(c):r&&!c?(r._cleanup?.(),n.removeChild(r)):r&&c&&(r.nodeType!==c.nodeType||r.tagName!==c.tagName?n.replaceChild(c,r):r.nodeType===3?r.nodeValue!==c.nodeValue&&(r.nodeValue=c.nodeValue):r.nodeType===1&&(re(r,c),B([...r.childNodes],[...c.childNodes],r)))}}s(B,"patchNodes");function re(e,t){let n={},o=new Set;for(let{name:r,value:c}of e.attributes)n[r]=c;for(let{name:r,value:c}of t.attributes)n[r]!==c&&e.setAttribute(r,c),o.add(r);for(let r in n)o.has(r)||e.removeAttribute(r)}s(re,"patchAttributes");var W=new WeakMap,h="\uFEFF",S=s((e,t,n)=>{if(t)if(e.removeAttribute(t),t==="ref")typeof n=="function"?n(e):n&&(n.current=e);else if(t[0]=="o"&&t[1]=="n"&&typeof n=="function"){let o=t.slice(2).toLowerCase();e.addEventListener(o,n),e._cleanup=()=>e.removeEventListener(o,n)}else t==="style"&&typeof n=="object"?d(()=>Object.assign(e.style,n)):d(()=>se(e,t,typeof n=="function"?n():n));else ie(e,n)},"render");function se(e,t,n){t==="value"||t==="checked"?e[t]=n:n===!1||n===null||n===void 0?e.removeAttribute(t):e.setAttribute(t,typeof n=="object"?R(n):n)}s(se,"setAttribute");function ce(e,t){let n=e.parentNode,o=e.nextSibling;for(;o&&o._marker;)o._cleanup?.(),n.removeChild(o),o=e.nextSibling;t?.length&&fe(a(t,{mark:!0}),n,e.nextSibling)}s(ce,"replaceNodes");function ie(e,t){let n=s(o=>{if((o===!0||o===!1)&&(o=""),Array.isArray(o))D(o,e);else{let r=o==null?"":String(o),c=document.createTextNode($(r));ce(e,[c])}},"updateContent");typeof t=="function"?d(()=>n(t())):n(t)}s(ie,"setContent");function fe(e,t,n=null){!e||!t||(n&&n.parentNode===t?t.insertBefore(e,n):t.appendChild(e))}s(fe,"insertFragment");function le(e,t){let n=[],o=document.createTreeWalker(e.content,5);for(;o.nextNode();)n.push(o.currentNode);let r=0;for(let c=0;c<n.length;c++){let i=n[c];if(i.nodeType===1&&i.attributes.length)for(let l of Array.from(i.attributes))l.value===h&&S(i,l.name,t[r++]);else if(i.nodeType===3&&i.nodeValue.includes(h))if(i.nodeValue===h){let l=document.createComment("");i.parentNode.replaceChild(l,i),S(l,null,t[r++])}else{let l=g(i.nodeValue.replaceAll(h,"<!>")),f=Array.from(l.content.childNodes);for(let u=0;u<f.length;u++){let x=f[u];x.nodeType===8&&S(x,null,t[r++])}i.parentNode.replaceChild(l.content,i)}}}s(le,"processTemplate");var g=s((e,t)=>{let n=document.createElement("template");return n.innerHTML=e,t?.as==="nodes"?[...n.content.childNodes]:n},"createNodes"),q=s((e,...t)=>{let n=W.get(e)||(W.set(e,e),e);if(!t.length)return n.length===1?g(n[0],{as:"nodes"}):g(n.join(""),{as:"nodes"});let o=g(n.join(h));return le(o,t),[...o.content.childNodes]},"html");function ue(e=null){let t=e;return n=>n!==void 0?t=n:t}s(ue,"ref");export{F as batch,X as beforeMount,J as beforeUpdate,oe as component,z as computed,d as effect,M as emit,q as html,Y as onDestroy,Z as onEffect,I as onMount,Q as onUpdate,ue as ref,m as signal};
//# sourceMappingURL=esor.min.js.map
